import{r as l,W as B,y as f}from"./app-BL-A_wWN.js";import{S as o}from"./sweetalert2.all-Dbsf46tK.js";function M({semesters:a=[]}){const[p,S]=l.useState([]),[u,d]=l.useState([]),{data:r,setData:i,processing:v,errors:x,patch:E,post:h}=B({subject:"",active:1,classrooms:[]});l.useEffect(()=>{if(a&&a.length>0){const e=a.map(t=>({...t,open:!1}));d(e)}},[a]);const b=(e,t)=>{var n;if(!e){const s=(n=r.classrooms)==null?void 0:n.filter(m=>m.semester_id!==t);i("classrooms",s)}const c=u.map(s=>s.id===t?{...s,open:e}:s);d(c)},g=(e,t)=>{if(!r.classrooms)return;const c=r.classrooms.find(s=>s.specialty_id===e&&s.semester_id===t);if(c){const s=r.classrooms.filter(m=>m.id!==c.id);i("classrooms",s);return}const n=[...r.classrooms,{id:Date.now(),specialty_id:e,semester_id:t}];i("classrooms",n)},C=()=>{var t;let e=[];return r.subject.trim()===""&&(e=[...e,"El Nombre de la Materia es Obligatoria"]),!r.id&&((t=r.classrooms)==null?void 0:t.length)===0&&(e=[...e,"Debe agregar al menos un aula"]),e},A=e=>{e.preventDefault();const t=C();if(S(t),t.length===0){if(r.id){E(route("subjects.update",{subject:r.id}),{preserveScroll:!0});return}h(route("subjects.store"),{preserveScroll:!0})}},D=e=>{o.fire({title:"Atención",text:"¿Desea eliminar la materia?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, Eliminar",cancelButtonText:"No, Cancelar"}).then(t=>{t.isConfirmed&&f.delete(route("subjects.destroy",{subject:e}),{preserveScroll:!0,onSuccess(){o.fire({title:"Exito",text:"La Materia se Elimino Correctamente",icon:"success"})},onError(){o.fire({title:"Error",text:"Ocurrio un Error al Eliminar la materia",icon:"error"})}})})},j=e=>{o.fire({title:"Atencion",text:e.active?"¿Desea desactivar la materia?":"¿Desea activar la materia?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No, Cancelar"}).then(t=>{t.isConfirmed&&f.patch(route("subjects.update",{subject:e}),{...e,active:!e.active,dashboard:!0},{preserveScroll:!0,onSuccess(){o.fire({title:"Exito",text:"La Materia se Actualizo Correctamente",icon:"success"})},onError(){o.fire({title:"Error",text:"Ocurrio un Error al Actualizar la materia",icon:"error"})}})})},w=l.useMemo(()=>e=>e.open,[u]);return{alerts:p,data:r,semestersOptions:u,setData:i,processing:v,errors:x,save:A,addSpecialty:g,activeSemester:b,handleDelete:D,handleActive:j,isOpen:w}}export{M as u};
